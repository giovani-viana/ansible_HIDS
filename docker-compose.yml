version: '3.8'

services:
  hips:
    build: .
    container_name: hips
    volumes:
      - ./scripts:/app/scripts
      - ./ansible.cfg:/app/ansible.cfg
      - ./Playbooks:/home/hids/ansible_HIPS/Playbooks
      - ~/.ssh:/home/hids/.ssh:ro
      - ./.env:/app/.env:ro
      - ./logs:/app/logs
    network_mode: "host"
    restart: always
    env_file:
      - .env
    command: python -m Api_watchdog.watchdog_service
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
        tag: "{{.Name}}"
    tty: true
    stdin_open: true
    environment:
      - PYTHONUNBUFFERED=1
      - ANSIBLE_FORCE_COLOR=1
      - ANSIBLE_STDOUT_CALLBACK=yaml
      - ANSIBLE_DISPLAY_ARGS_TO_STDOUT=1
      - ANSIBLE_VERBOSITY=3
      - TERM=xterm-256color
